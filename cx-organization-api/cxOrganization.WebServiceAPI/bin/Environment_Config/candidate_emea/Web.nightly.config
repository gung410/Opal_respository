<?xml version="1.0"?>
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

  <!-- !!!! ======================================================================================== !!!! -->
  <!-- !!!! Remember to change the build for this file: File must be marked Content + Copy to Output !!!! -->
  <!-- !!!! ======================================================================================== !!!! -->
  <appSettings>
    <add key="serviceUsername" value="nightlyuser" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="servicePassword" value="nightlypassword" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="OwnerId" value="1001" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="SiteId" value="1" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="HDID" value="2" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="MasterRedisConfiguration"  value="test-ck-emea-cache.redis.cache.windows.net:6380,defaultDatabase=4,connectRetry=5,connectTimeout=10000,keepAlive=30,abortConnect=false,allowAdmin=true,password=TUT2v8lWfB5xY8sbmwRTzCaoaZqDxIbrcDBnafCS5mk=,ssl=True" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="SlaveRedisConfiguration"  value="test-ck-emea-cache.redis.cache.windows.net:6380,defaultDatabase=4,connectRetry=5,connectTimeout=10000,keepAlive=30,abortConnect=false,allowAdmin=true,password=TUT2v8lWfB5xY8sbmwRTzCaoaZqDxIbrcDBnafCS5mk=,ssl=True" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="DisableCheckAccessRule" value="True" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="UserTypeEmployee" value="49" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="CurrentUserId" value="1" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="EventAPIBaseUrl" value="http://nightly-candidate-emea-api-event.azurewebsites.net" xdt:Transform="Replace"  xdt:Locator="Match(key)" />
    <add key="EventAPIAuthorization" value="Basic bmlnaHRseXVzZXI6bmlnaHRseXBhc3N3b3Jk" xdt:Transform="Replace"  xdt:Locator="Match(key)" />
    <add key="AuthorityUrl" value="https://systemtest-cxid-emea-idp.azurewebsites.net" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="CheckSingleUserAccess" value="true" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
    <add key="UseSeparateQAndRDatabase" value="false" xdt:Transform="Replace"  xdt:Locator="Match(key)"/>
  </appSettings>

  <connectionStrings>
    <add name="ErrorLogging" connectionString="Data Source=test-ckemea-dbserver.database.windows.net,1433;Initial Catalog=test-emea-elmah;Persist Security Info=True;User ID=ckemeatestadmin; Password=a3Dm2pQFxb6Y" providerName="System.Data.SqlClient" xdt:Transform="Replace"  xdt:Locator="Match(name)"/>
    <add name="AT6QDBTemplate" connectionString="Data Source=test-ckemea-dbserver.database.windows.net,1433;Initial Catalog=nightly-candidate-emea-at6qr; User ID=ckemeatestadmin;Password=a3Dm2pQFxb6Y" providerName="System.Data.SqlClient" xdt:Transform="Replace"  xdt:Locator="Match(name)"/>
  </connectionStrings>
  <businessConfigs>
    <candidateListConfig>
      <jobmatchActivityExtIds  xdt:Transform="Replace">
        <add value="ip" />
        <add value="ip2" />
      </jobmatchActivityExtIds>
      <profileActivityExtIds xdt:Transform="Replace">
        <add value="ip" />
        <add value="ip2" />
        <add value="pp" />
      </profileActivityExtIds>
    </candidateListConfig>
  </businessConfigs>
  <elmah>
    <errorLog xdt:Transform="Remove" />
    <errorLog type=
    "Elmah.SqlErrorLog, Elmah" connectionStringName="ErrorLogging" applicationName="nightly-candidate-emea-api-assessment" xdt:Transform="InsertIfMissing" />
  </elmah>

  <system.web>
    <compilation xdt:Transform="RemoveAttributes(debug)" />
  </system.web>

  <log4net xdt:Transform="Remove" />
  <log4net xdt:Transform="InsertIfMissing">
    <root>
      <level value="INFO" />
      <appender-ref ref="RollingLogFileAppender" />
      <appender-ref ref="ElasticSearchAppender" />
    </root>
    <appender name="ElasticSearchAppender" type="log4stash.ElasticSearchAppender, log4stash">
      <Server>cct-logging-mgmt.westeurope.cloudapp.azure.com</Server>
      <Port>9200</Port>
      <IndexName>nightly-app-%{+yyyy-MM-dd}</IndexName>
      <IndexType>LogEvent</IndexType>
      <Bulksize>100</Bulksize>
      <BulkIdleTimeout>5000</BulkIdleTimeout>
      <IndexAsync>False</IndexAsync>
      <evaluator type="log4net.Core.LevelEvaluator">
        <threshold value="ERROR" />
      </evaluator>
      <!-- for more information read about log4net.Core.FixFlags -->
      <FixedFields>Partial</FixedFields>
      <ElasticFilters>
        <Add>
          <Key>sitename</Key>
          <Value>nightly-candidate-emea-api-organization</Value>
        </Add>
      </ElasticFilters>
    </appender>
    <appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="App_Data\nightly-candidate-emea-api-assessment-log.log" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="100" />
      <maximumFileSize value="2MB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{RequestId}] [%property{CorrelationId}] - %message%newline" />
      </layout>
    </appender>
  </log4net>
</configuration>